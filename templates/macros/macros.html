{% macro list_posts(pages) %}
    <ul>
    {%- for page in pages %}
        <section class="list-item">
            <h1 class="title">
                <a href={{ page.permalink }}>{{page.title}}</a>
            </h1>

            <div class="meta">
                {%- if page.date %}
                    <time>{{ page.date | date(format="%Y-%m-%d") }}</time>
                {% endif -%}
                {% if page.draft %}
                    <span class="draft-label">DRAFT</span> 
                {% endif %}
            </div>

            
            <div class="description">
                {% if page.description %}
                <br>
                    {{ page.description }}
                {% elif page.summary %}
                    {{ page.summary | safe }}&hellip;
                {% else %}
                    {% set hide_read_more = true %}
                {% endif %}
            </div>

            {% if not hide_read_more %}
            <br>
                <a class="readmore" href={{ page.permalink }}>Read more ‚ü∂</a>
            {% endif %}
        </section>

    {% endfor -%}
    </ul>
{% endmacro list_posts %}

{% macro tags(page, short=false) %}
    {%- if page.taxonomies and page.taxonomies.tags %}
        <span class="post-tags-inline">
            {%- if short %}
                ::
                {%- set sep = "," -%}
            {% else %}
                :: tags:&nbsp;
                {%- set sep = "&nbsp;" -%}
            {% endif -%}
            {%- for tag in page.taxonomies.tags %}
                <a class="post-tag" href="{{ get_taxonomy_url(kind='tags', name=tag) | safe }}">#{{ tag }}</a>
                {%- if not loop.last %}{{ sep | safe }}{% endif -%}
            {% endfor -%}
        </span>
    {% endif -%}
{% endmacro tags %}

{% macro page_header(title) %}
    <div class="page-header">
        {{ title }}<span class="primary-color" style="font-size: 1.6em">.</span>
    </div>
{% endmacro content %}

{% macro content(page) %}
<main>
    <article>
        <div class="title">
            {#<h1 class="title">{{ page.title }}</h1>#}
            {{ post_macros::page_header(title=page.title) }}

                <div class="meta">
                    {% if page.date %}
                        Posted on <time>{{ page.date | date(format="%Y-%m-%d") }}</time>
                    {% endif %}

                    {% if page.extra.edited %}
                        , last edited on <time>{{ page.extra.edited | date(format="%Y-%m-%d") }}</time>
                    {% endif %}

                    {% if page.draft %}
                        <span class="draft-label">DRAFT</span> 
                    {% endif %}
                </div>
        </div>

        {% if page.extra.tldr %}
            <div class="tldr">
                <strong>tl;dr:</strong>
                {{ page.extra.tldr }}
            </div>
        {% endif %}

        {# Optional table of contents #}
        {% if not page.extra.toc_not_generate %}
            {% if config.extra.toc | default(value=false) %}
                {% if page.toc %}
                    <h1>Table of Contents</h1>
                    <ul>
                    {% for h1 in page.toc %}
                        <li>
                            <a href="{{ h1.permalink | safe }}">{{ h1.title }}</a>
                            {% if h1.children %}
                                <ul>
                                    {% for h2 in h1.children %}
                                        <li>
                                            <a href="{{ h2.permalink | safe }}">{{ h2.title }}</a>
                                        </li>

                                        {% if h2.children %}
                                        <ul>
                                            {% for h3 in h2.children %}
                                                <li>
                                                    <a href="{{ h3.permalink | safe }}">{{ h3.title }}</a>
                                                </li>
                                            {% endfor %}
                                        </ul>
                                        {% endif %}
                                    {% endfor %}
                                </ul>
                            {% endif %}
                        </li>
                    {% endfor %}
                    </ul>
                {% endif %}
            {% endif %}
        {% endif %}

        <section class="body">
            {{ page.content | safe }}
        </section>

        {% if page.taxonomies and page.taxonomies.tags %}
            <div class="post-tags">
                <nav class="nav tags">
                    <ul class="tags">
                        {% for tag in page.taxonomies.tags %}
                            <li><a href={{ get_taxonomy_url(kind='tags', name=tag) | safe }}>{{ tag }}</a></li>
                        {% endfor %}
                    </ul>
                </nav>
            </div>
        {% endif %}

    </article>
</main>
{% endmacro content %}

{% macro cards_posts(pages) %}
    <div class="cards">
    {%- for page in pages %}
        <div class="card">
            {% if page.extra.local_image %}
                <img class="card-image" alt={{ page.extra.local_image }} src="{{ get_url(path=page.extra.local_image) }}">
            {% elif page.extra.remote_image %}
                <img class="card-image" alt={{ page.extra.remote_image }} src="{{ page.extra.remote_image }}">
            {% else %}
                <div class="card-image-placeholder"></div>
            {% endif %}

            <div class="card-info">
                <h1 class="card-title">
                    {% if page.extra.link_to %}
                    <a href={{ page.extra.link_to }}>{{page.title}}</a>
                    {% else %}
                    <a href={{ page.permalink }}>{{page.title}}</a>
                    {% endif %}
                </h1>

                <div class="meta">
                    {%- if page.date %}
                        <time>{{ page.date | date(format="%Y-%m-%d") }}</time>
                    {% endif -%}
                    {% if page.draft %}
                        <span class="draft-label">DRAFT</span> 
                    {% endif %}
                </div>

                <div class="card-description">
                    {% if page.description %}
                        {{ page.description }}
                    {% endif %}
                </div>
            </div>
        </div>

    {% endfor -%}
    </div>
{% endmacro cards_posts %}

{# Schema markup macros for SEO #}
{% macro article_schema(page) %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{ page.title }}",
  "author": {
    "@type": "Person",
    "name": "Bob Peters",
    "url": "{{ config.base_url }}/about",
    "sameAs": [
      "{{ config.extra.socials | filter(attribute='name', value='linkedin') | first | get(key='url') }}",
      "{{ config.extra.socials | filter(attribute='name', value='github') | first | get(key='url') }}"
    ]
  },
  "publisher": {
    "@type": "Organization",
    "name": "{{ config.title }}",
    "url": "{{ config.base_url }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ config.base_url }}/icon/favicon.ico"
    }
  },
  {% if page.date %}"datePublished": "{{ page.date | date(format='%Y-%m-%d') }}",{% endif %}
  {% if page.extra.edited %}"dateModified": "{{ page.extra.edited | date(format='%Y-%m-%d') }}",{% elif page.date %}"dateModified": "{{ page.date | date(format='%Y-%m-%d') }}",{% endif %}
  "description": "{{ page.description | default(value=page.summary | default(value='') | striptags) }}",
  "url": "{{ page.permalink }}",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ page.permalink }}"
  },
  {% if page.taxonomies and page.taxonomies.tags %}"keywords": [{% for tag in page.taxonomies.tags %}"{{ tag }}"{% if not loop.last %},{% endif %}{% endfor %}],{% endif %}
  "articleSection": "{% if 'newsletter' in page.permalink %}Newsletter{% else %}Tutorial{% endif %}",
  "inLanguage": "en-US"
}
</script>
{% endmacro article_schema %}

{% macro organization_schema() %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "{{ config.title }}",
  "url": "{{ config.base_url }}",
  "logo": "{{ config.base_url }}/icon/favicon.ico",
  "description": "The premier newsletter and resource for Rust programming trends, tutorials, and ecosystem updates.",
  "foundingDate": "2022",
  "founder": {
    "@type": "Person",
    "name": "Bob Peters"
  },
  "sameAs": [
    {% for social in config.extra.socials %}"{{ social.url }}"{% if not loop.last %},{% endif %}{% endfor %}
  ],
  "contactPoint": {
    "@type": "ContactPoint",
    "contactType": "customer support",
    "url": "{{ config.base_url }}/contact"
  }
}
</script>
{% endmacro organization_schema %}

{% macro newsletter_schema(page) %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Newsletter",
  "name": "{{ page.title }}",
  "description": "{{ page.description | default(value=page.summary | default(value='') | striptags) }}",
  "url": "{{ page.permalink }}",
  {% if page.date %}"datePublished": "{{ page.date | date(format='%Y-%m-%d') }}",{% endif %}
  "author": {
    "@type": "Person",
    "name": "Bob Peters",
    "url": "{{ config.base_url }}/about"
  },
  "publisher": {
    "@type": "Organization",
    "name": "{{ config.title }}",
    "url": "{{ config.base_url }}"
  },
  "inLanguage": "en-US",
  "isPartOf": {
    "@type": "PeriodicalSeries",
    "name": "Rust Trends Newsletter",
    "description": "Weekly newsletter covering Rust programming trends, tutorials, and ecosystem updates"
  }
}
</script>
{% endmacro newsletter_schema %}

{% macro breadcrumb_schema(page) %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "{{ config.base_url }}"
    },
    {% if 'newsletter' in page.permalink %}
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Newsletter",
      "item": "{{ config.base_url }}/newsletter"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "{{ page.title }}",
      "item": "{{ page.permalink }}"
    }
    {% elif 'posts' in page.permalink %}
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Posts",
      "item": "{{ config.base_url }}/posts"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "{{ page.title }}",
      "item": "{{ page.permalink }}"
    }
    {% else %}
    {
      "@type": "ListItem",
      "position": 2,
      "name": "{{ page.title }}",
      "item": "{{ page.permalink }}"
    }
    {% endif %}
  ]
}
</script>
{% endmacro breadcrumb_schema %}

{% macro website_schema() %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "{{ config.title }}",
  "url": "{{ config.base_url }}",
  "description": "The premier newsletter and resource for Rust programming trends, tutorials, and ecosystem updates.",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "{{ config.base_url }}/search?q={search_term_string}",
    "query-input": "required name=search_term_string"
  },
  "publisher": {
    "@type": "Organization",
    "name": "{{ config.title }}",
    "url": "{{ config.base_url }}"
  }
}
</script>
{% endmacro website_schema %}

{# Breadcrumb navigation component #}
{% macro breadcrumb_nav(page) %}
<nav class="breadcrumb" aria-label="Breadcrumb">
    <ol class="breadcrumb-list">
        <li class="breadcrumb-item">
            <a href="{{ config.base_url }}">Home</a>
        </li>
        {% if 'newsletter' in page.permalink %}
            <li class="breadcrumb-item">
                <a href="{{ config.base_url }}/newsletter">Newsletter</a>
            </li>
            <li class="breadcrumb-item current" aria-current="page">
                {{ page.title }}
            </li>
        {% elif 'posts' in page.permalink %}
            <li class="breadcrumb-item">
                <a href="{{ config.base_url }}/posts">Posts</a>
            </li>
            <li class="breadcrumb-item current" aria-current="page">
                {{ page.title }}
            </li>
        {% else %}
            <li class="breadcrumb-item current" aria-current="page">
                {{ page.title }}
            </li>
        {% endif %}
    </ol>
</nav>
{% endmacro breadcrumb_nav %}